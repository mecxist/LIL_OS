version: 1

paths:
  docs_dir: "docs"
  master_rules: "docs/MASTER_RULES.md"
  governance: "docs/GOVERNANCE.md"
  context_budget: "docs/CONTEXT_BUDGET.md"
  reset_triggers: "docs/RESET_TRIGGERS.md"
  decision_log: "docs/DECISION_LOG.md"
  cursor_rules: ".cursorrules"
  memory_dir: "memory"
  agents_dir: "agents"

windows:
  rule_velocity_days: 30
  decision_log_rolling_entries: 20

thresholds:
  rule_velocity_consecutive_windows: 2
  justification_decay_incomplete_entries: 2
  max_rules: 120
  max_agents: 8
  max_memory_artifacts: 200
  metric_dominance_consecutive_decisions: 3
  override_normalization_per_window: 2

checks:
  check_automation_creep: true
  check_rule_contradiction: true
  use_enhanced_contradiction_detection: false

conventions:
  decision_log_required_fields:
    - "Date:"
    - "Decision:"
    - "Trigger:"
    - "Rationale:"
    - "Tradeoffs:"
    - "Expected Impact:"
    - "Review Date:"
  override_markers:
    - "OVERRIDE"
    - "EMERGENCY OVERRIDE"
    - "Override Conditions"
  metric_markers:
    - "Metric:"
    - "Primary metric:"
    - "Optimized for"
    - "KPI:"
  memory_required_metadata:
    - "Purpose:"
    - "Retention:"
    - "Review Trigger:"
  automation_keywords:
    - "automate"
    - "automation"
    - "automatic"
    - "auto-"
    - "AI decision"
    - "agent decides"
    - "system chooses"
    - "without human"
    - "no human"
    - "unattended"
  forbidden_domains:
    - "value judgment"
    - "moral"
    - "ethics"
    - "ethical"
    - "irreversible harm"
    - "permanent damage"
    - "without audit"
    - "no audit trail"
    - "no logging"

security:
  check_decision_log_integrity: true
  check_governance_file_changes: true
  check_secrets: true
  # Enable manually after setting expected checksums
  check_script_checksums: false
  secret_patterns:
    # API Keys - must have key=value format with actual secret value
    - "(?i)(api[_-]?key|apikey)[\s:=]+['\"]?([a-zA-Z0-9_\-]{32,})['\"]?"
    - "(?i)(secret[_-]?key|secretkey)[\s:=]+['\"]?([a-zA-Z0-9_\-]{32,})['\"]?"
    # Access tokens - must have token=value format with actual token
    - "(?i)(access[_-]?token|accesstoken)[\s:=]+['\"]?([a-zA-Z0-9_\-]{32,})['\"]?"
    - "(?i)(bearer[_-]?token)[\s:=]+['\"]?([a-zA-Z0-9_\-]{32,})['\"]?"
    # AWS credentials
    - "(?i)(aws[_-]?access[_-]?key[_-]?id)[\s:=]+['\"]?(AKIA[0-9A-Z]{16})['\"]?"
    - "(?i)(aws[_-]?secret[_-]?access[_-]?key)[\s:=]+['\"]?([a-zA-Z0-9/+=]{40})['\"]?"
    # GitHub tokens - specific token formats
    - "ghp_[a-zA-Z0-9]{36}"
    - "gho_[a-zA-Z0-9]{36}"
    - "ghu_[a-zA-Z0-9]{36}"
    - "ghs_[a-zA-Z0-9]{36}"
    - "ghr_[a-zA-Z0-9]{76}"
    # Generic tokens - must be standalone or have =value format with long value
    - "(?i)(auth[_-]?token)[\s:=]+['\"]?([a-zA-Z0-9_\-]{40,})['\"]?"
    # Passwords - must have password=value format with actual password
    - "(?i)(password|passwd|pwd)[\s:=]+['\"]?([a-zA-Z0-9_\-!@#$%^&*+=]{12,})['\"]?"
    # Private keys - exact format match
    - "-----BEGIN[\\s]+(RSA|DSA|EC|OPENSSH)[\\s]+PRIVATE[\\s]+KEY-----"
    # Database connections - must have actual connection string
    - "(?i)(database[_-]?url|db[_-]?url|connection[_-]?string)[\s:=]+['\"]?(mongodb|postgres|mysql|redis)://[a-zA-Z0-9_\-:]+@[^\s'\"]+['\"]?"
    # OAuth secrets - must have secret=value format
    - "(?i)(client[_-]?secret|oauth[_-]?secret)[\s:=]+['\"]?([a-zA-Z0-9_\-]{32,})['\"]?"
  script_checksums:
    # SHA256 checksums - update these when scripts are intentionally modified
    # To calculate: python3 -c "import hashlib; print(hashlib.sha256(open('scripts/FILENAME','rb').read()).hexdigest())"
    lil_os_rule_id_lint.py: "d6d34849d33b366a40a923f793f25693866c905a55f1c9dc061cdec28e7c4a35"
    lil_os_reset_checks.py: "4af39f26137b05d6aef5309963f315d08ca47057c530341ff757aa4c5aed46ae"
